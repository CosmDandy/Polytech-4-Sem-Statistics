```python
import pandas as pd
import numpy as np
import scipy.stats as st
from IPython.display import display, Markdown
```

# Лабораторная работа №4
## Задание 2
### {Фамилия Имя}, {Номер группы}, Вариант {Номер варианта}, ({Дата})

## Задача и данные

По данным двух выборок нормального закона распределения проверить гипотезу о равенстве генеральных средних (при конкурирующей гипотезе об их неравенстве) при уровне значимости α = 0,1.

В ответе привести:
1) выборочное среднее для первой выборки;
2) выборочное среднее для второй выборки;
3) вычисленное значение критерия;
4) табличное значение;
5) вывод о принятии или не принятии гипотезы.


```python
x = pd.Series([74.9, 72.2, 110, 29.7, 68.8, 65.2, 70.9, 73.2, 70.7, 65.2, 82.4, 43.8, 60.9])
y = pd.Series([57, 84, 22.7,	45.2, 45.3,	20.9, 3, 24.2, 71.9, 43.9, 10.3])
n_x = len(x)
n_y = len(y)
a = 0.1

Markdown(f'Уровень значимости: ${a}$')
```




Уровень значимости: $0.1$



### Количество элементов в выборках:


```python
print(f'Количество элементов в первой выборке: {n_x}')
```

    Количество элементов в первой выборке: 13



```python
print(f'Количество элементов во второй выборке: {n_y}')
```

    Количество элементов во второй выборке: 11


### Выборки:

#### Первая выборка:


```python
x
```




    0      74.9
    1      72.2
    2     110.0
    3      29.7
    4      68.8
    5      65.2
    6      70.9
    7      73.2
    8      70.7
    9      65.2
    10     82.4
    11     43.8
    12     60.9
    dtype: float64



#### Вторая выборка:


```python
y
```




    0     57.0
    1     84.0
    2     22.7
    3     45.2
    4     45.3
    5     20.9
    6      3.0
    7     24.2
    8     71.9
    9     43.9
    10    10.3
    dtype: float64



## Проверка гипотезы о равенстве генеральных средних

$$
H_0: \mu_x = \mu_y \\
H_1: \mu_x \neq \mu_y
$$

### Вычисление выборочных средних:

$$
\overline{x} = \frac{1}{n_x} \sum_{i = 1}^{n_x} x_i, \quad \overline{y} = \frac{1}{n_y} \sum_{i = 1}^{n_y} y_i
$$


```python
x_mean = x.mean()
print(f'Выборочное среднее первой выборки: {x_mean}')
```

    Выборочное среднее первой выборки: 68.30000000000001



```python
y_mean = y.mean()
print(f'Выборочное среднее второй выборки: {y_mean}')
```

    Выборочное среднее второй выборки: 38.945454545454545


### Вычисление дисперсий выборок:

$$S^2 = \frac{(n_x - 1)S^2_x + (n_y - 1)S^2_y}{n_x + n_y - 2}$$


```python
S_pow_2 = ((n_x - 1) * x.var(ddof=0) + (n_y - 1) * y.var(ddof=0))/(n_x + n_y - 2)
Markdown(f"$S^2 = {S_pow_2}$")
```




$S^2 = 443.28773854244935$



### Вычисление t-критерия Стьюдента:

$$
t = \frac{\overline{X} - \overline{Y}}{S\sqrt{\frac{1}{n_x} + \frac{1}{n_y}}}
$$


```python
t_r = (x_mean - y_mean) / ((S_pow_2 * (1 / n_x + 1 / n_y) ) ** 0.5)
print(f'Вычисленное значение критерия: {t_r}')
```

    Вычисленное значение критерия: 3.4032581901981716


### Вычисление табличного t-криетрия Стьюдента:

$$
t_{кр} = t_{1 - \frac{\alpha}{2}, n_x + n_y - 2}
$$


```python
t_t = st.t.ppf(1 - a / 2, n_x + n_y - 2)
print(f'Табличное значение критерия: {t_t}')
```

    Табличное значение критерия: 1.717144374380242


## Вывод о принятии или не принятии гипотезы


```python
if abs(t_r) < t_t:
    display(Markdown('Гипотеза о равенстве дисперсий принимается ($H_0$)'))
else:
    display(Markdown('Гипотеза о равенстве дисперсий отвергается ($H_0$), принимается альтернативная гипотеза ($H_1$), т.к. $|t| > t_{кр}$'))
```


Гипотеза о равенстве дисперсий отвергается ($H_0$), принимается альтернативная гипотеза ($H_1$), т.к. $|t| > t_{кр}$

