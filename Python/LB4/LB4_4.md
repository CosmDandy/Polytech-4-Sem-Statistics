```python
import pandas as pd
import scipy.stats as st
import numpy as np
from IPython.display import Markdown, display
```

# Лабораторная работа №4
## Задание 4
### {Фамилия Имя}, {Номер группы}, Вариант {Номер варианта}, ({Дата})

## Задача и данные

При проведении $n_1$ испытаний в первой серии число благоприятных исходов равнялось $m_1$. Во второй серии из $n_2$ испытаний число благоприятных исходов равнялось $m_2$. Проверить гипотезу о равенстве вероятностей благоприятного исхода в двух сериях (при конкурирующей гипотезе об их неравенстве) при уровне значимости $α$.

В ответе привести:
1) вычисленное значение критерия;
2) критическое значение;
3) вывод о принятии или не принятии гипотезы.


```python
a = 0.01
n1 = 500
m1 = 327
n2 = 700
m2 = 403
Markdown(f'- Уровень значимости: a = {a},\n- Количество испытаний в первой серии: n1 = {n1},\n- Количество благоприятных исходов в первой серии: m1 = {m1},\n- Количество испытаний во второй серии: n2 = {n2},\n- Количество благоприятных исходов во второй серии: m2 = {m2}')
```




- Уровень значимости: a = 0.01,
- Количество испытаний в первой серии: n1 = 500,
- Количество благоприятных исходов в первой серии: m1 = 327,
- Количество испытаний во второй серии: n2 = 700,
- Количество благоприятных исходов во второй серии: m2 = 403



## Проверка гипотезы о равенстве вероятностей благоприятного исхода в двух сериях

$$
H_0: p_1 = p_2 \\
H_1: p_1 \neq p_2
$$

### Вычисление вероятностей

$$
W_1 = \frac{m_1}{n_1}
$$


```python
w1 = m1 / n1
Markdown(f'Вероятность благоприятного исхода в первой серии: $W_1 = {w1}$')
```




Вероятность благоприятного исхода в первой серии: $W_1 = 0.654$



$$
W_2 = \frac{m_2}{n_2}
$$


```python
w2 = m2 / n2
Markdown(f'Вероятность благоприятного исхода в первой серии: $W_2 = {w2}$')
```




Вероятность благоприятного исхода в первой серии: $W_2 = 0.5757142857142857$



$$
p = \frac{m_1 + m_2}{n_1 + n_2}
$$


```python
p = (m1 + m2) / (n1 + n2)
Markdown(f'Вероятность благоприятного исхода в обеих сериях: $p = {p}$')
```




Вероятность благоприятного исхода в обеих сериях: $p = 0.6083333333333333$



### Вычисление критерия

$$
z = \frac{W_1 - W_2}{\sqrt{p(1 - p)(\frac{1}{n_1} + \frac{1}{n_2})}}
$$


```python
z = (w1 - w2) / np.sqrt(p * (1 - p) * (1 / n1 + 1 / n2))
print(f'Вычисленное значение критерия: {z}')
```

    Вычисленное значение критерия: 2.739030098563068


### Табличное значение критерия

$$
z_t = \Phi^{-1}(1 - \frac{a}{2})
$$


```python
z_critical = st.norm.ppf(1 - a / 2)
print(f'Табличное значение критерия: {z_critical}')
```

    Табличное значение критерия: 2.5758293035489004


## Вывод о принятии или не принятии гипотезы


```python
if np.abs(z) < z_critical:
    display(Markdown('Принимаем гипотезу о равенстве вероятностей благоприятного исхода в двух сериях (H0)'))
else:
    display(Markdown('Отвергаем гипотезу о равенстве вероятностей благоприятного исхода в двух сериях (H0), принимаем гипотезу о неравенстве вероятностей благоприятного исхода в двух сериях (H1)'))
```


Отвергаем гипотезу о равенстве вероятностей благоприятного исхода в двух сериях (H0), принимаем гипотезу о неравенстве вероятностей благоприятного исхода в двух сериях (H1)

